(async()=>{let i=null;function e(e=500){return new Promise(t=>{let c=!1;const n=setInterval(async()=>{if(!c){c=!0;var e=await BG.exec("get_settings");if(e.enabled&&e.awscaptcha_auto_solve){e=document.querySelector('input[placeholder="Answer"]');if(e&&""===e.value){var a=function(){try{return document.querySelector("audio").src.replace("data:audio/aac;base64,","")}catch(e){}return null}();if(a&&i!==a)return i=a,clearInterval(n),c=!1,t({input:e,audio_data:a})}c=!1}}},e)})}for(;;){await Time.sleep(1e3);var a,t,c,n,o,l=await BG.exec("get_settings");if(l&&l.enabled)if(l.awscaptcha_auto_open&&null!==document.querySelector("#captcha-container > #root #amzn-captcha-verify-button")){r=void 0;try{var r=document.querySelector("#captcha-container > #root #amzn-captcha-verify-button");r&&r.click()}catch(e){}await 0}else if(l.hcaptcha_auto_solve&&null!==document.querySelector('#captcha-container > #root #amzn-btn-audio-internal > img[title="Audio problem"]')){r=void 0;try{r=document.querySelector("#captcha-container > #root #amzn-btn-audio-internal");r&&r.click()}catch(e){}await 0}else l.hcaptcha_auto_solve&&null!==document.querySelector('#captcha-container > #root #amzn-btn-audio-internal > img[title="Visual problem"]')&&(c=t=a=n=o=l=void 0,{input:l,audio_data:o}=await e(),await!(null!==l&&null!==o&&(n=await BG.exec("get_settings")).enabled&&n.awscaptcha_auto_solve&&(a=Time.time(),{job_id:t,data:o}=await NopeCHA.post({captcha_type:IS_DEVELOPMENT?"awscaptcha_dev":"awscaptcha",audio_data:[o],key:n.key}),!o||0===o.length||(c=(c=parseInt(n.awscaptcha_solve_delay_time))||1e3,0<(n=n.awscaptcha_solve_delay?c-(Time.time()-a):0)&&await Time.sleep(n),0===o[0].length)?(document.querySelector("#amzn-btn-refresh-internal")?.click(),await Time.sleep(200),i=null):(l.value=o[0],await Time.sleep(200),document.querySelector("#amzn-btn-verify-internal")?.click()))))}})();
